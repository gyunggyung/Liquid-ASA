# ASA Ã— LFM2.5-1.2B-Instruct

**í•™ìŠµ ì—†ì´ ë„êµ¬ í˜¸ì¶œ ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” í™œì„±í™” ìŠ¤í‹°ì–´ë§**

[ğŸ‡ºğŸ‡¸ English Version](README_EN.md)

---

## ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” **ASA (Activation Steering Adapter)** ê¸°ë²•ì„ [LiquidAI/LFM2.5-1.2B-Instruct](https://huggingface.co/LiquidAI/LFM2.5-1.2B-Instruct) ëª¨ë¸ì— ì ìš©í•©ë‹ˆë‹¤.

LFM2.5ëŠ” 10ê°œ LIV ì»¨ë³¼ë£¨ì…˜ ë¸”ë¡ + 6ê°œ GQA ì–´í…ì…˜ ë¸”ë¡ìœ¼ë¡œ êµ¬ì„±ëœ **1.17B íŒŒë¼ë¯¸í„° í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸**ì…ë‹ˆë‹¤.

ASAëŠ” **ëª¨ë¸ ì¬í•™ìŠµ ì—†ì´** ì¶”ë¡  ì‹œì ì—ì„œ ë„êµ¬ í˜¸ì¶œ ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚¤ë©°, ì¶”ê°€ ì—ì…‹ í¬ê¸°ëŠ” ë‹¨ ~221KBì…ë‹ˆë‹¤.

> ğŸ“„ ë…¼ë¬¸: [ASA: Training-Free Representation Engineering for Tool-Calling Agents](https://arxiv.org/abs/2602.04935)

## ì‹¤í—˜ ê²°ê³¼

[Alpaca](https://huggingface.co/datasets/tatsu-lab/alpaca) ê³µê°œ ë°ì´í„°ì…‹ì—ì„œ ë„ë©”ì¸ë³„ í•„í„°ë§ìœ¼ë¡œ êµ¬ì¶•í•œ **1,600 ìƒ˜í”Œ ë²¤ì¹˜ë§ˆí¬**ì—ì„œ í‰ê°€. ë…¼ë¬¸ í”„ë¡œí† ì½œ ì¤€ìˆ˜ (greedy ë””ì½”ë”©, strict `<|tool_call_start|>` íŠ¸ë¦¬ê±° ê°ì§€, ë¶„ë¦¬ëœ ë°ì´í„° ë¶„í• ).

### Baseline vs ASA (TEST, 640 ìƒ˜í”Œ)

| ë©”íŠ¸ë¦­ | Baseline | ASA | ë³€í™” |
|--------|----------|-----|------|
| **Trigger Precision** | 0.4959 | **0.7591** | +53% â†‘ |
| **Trigger Recall** | 0.5656 | 0.5219 | -8% â†“ |
| **Trigger F1** | 0.5285 | **0.6185** | +17% â†‘ |
| **FPR (ì˜¤íƒë¥ )** | 0.5750 | **0.1656** | **-71%** â†“â†“ |
| **Accuracy** | 0.4953 | **0.6781** | +37% â†‘ |

**í•µì‹¬ ë°œê²¬:** ë² ì´ìŠ¤ë¼ì¸ì€ non-tool ì§ˆë¬¸ì˜ 57.5%ì—ì„œ ì˜ëª» toolì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤. ASA ì ìš© í›„ 16.6%ë¡œ 71% ê°ì†Œ.

### ë„ë©”ì¸ë³„ (ASA)

| ë„ë©”ì¸ | F1 | Precision | Recall | FPR |
|--------|----|-----------|--------|-----|
| ë²ˆì—­ | **0.9262** | 1.0000 | 0.8625 | 0.0000 |
| ìˆ˜í•™ | 0.7273 | 0.7568 | 0.7000 | 0.2250 |
| ê²€ìƒ‰ | 0.5410 | 0.7857 | 0.4125 | 0.1125 |
| ì½”ë“œ | 0.1565 | 0.2571 | 0.1125 | 0.3250 |

### Ablation ì—°êµ¬ (ë…¼ë¬¸ Â§4.3)

| ë³€í˜• | F1 | FPR | ì˜ë¯¸ |
|------|-----|-----|------|
| **Full ASA** | **0.8054** | 0.2375 | ìµœì  ê· í˜• |
| No Gate | 0.6667 | **1.0000** | ê²Œì´íŠ¸ê°€ í•µì‹¬ ì•ˆì „ì¥ì¹˜ |
| Global Only | 0.8054 | 0.2375 | ê°•ë ¥í•œ ê¸°ë³¸ ë°©í–¥ |
| Domain Only | 0.8054 | 0.2375 | ë„ë©”ì¸ë³„ ë¼ìš°íŒ… |

### íŒŒì´í”„ë¼ì¸ ì„¤ì •

| íŒŒë¼ë¯¸í„° | ê°’ |
|----------|-----|
| ìµœì  ë ˆì´ì–´ L* | **12** (GQA ë¸”ë¡) |
| Probe AUC at L* | 0.8810 |
| Î± (ìŠ¤í‹°ì–´ë§ ê°•ë„) | 1.0 |
| Ï„ (ì‹ ë¢° ì„ê³„ê°’) | 0.50 |
| Î² (MoV ê¸€ë¡œë²Œ ê°€ì¤‘ì¹˜) | 0.0 |
| ì—ì…‹ í¬ê¸° | 221 KB |

### í•œê³„

- **Success Precision = 0**: LFM2.5ëŠ” tool callì„ bracket í˜•ì‹(`[func(args)]`)ìœ¼ë¡œ ì¶œë ¥í•˜ëŠ”ë°, JSON íŒŒì„œë¡œ ê²€ì¦í•˜ë¯€ë¡œ 0ì´ ë¨. íŠ¸ë¦¬ê±° ë©”íŠ¸ë¦­ì—ëŠ” ì˜í–¥ ì—†ìŒ.
- **Code ë„ë©”ì¸ ì•½ì ** (F1=0.16): Alpaca í‚¤ì›Œë“œ ê¸°ë°˜ ë¼ë²¨ë§ì´ ì½”ë“œ ê´€ë ¨ ì¿¼ë¦¬ì—ì„œ ë…¸ì´ì¦ˆê°€ ë§ìŒ.
- **Edge case ì¡´ì¬**: ìœ íš¨í•œ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì–µì œí•˜ê±°ë‚˜ ì² í•™ì  ì§ˆë¬¸ì— toolì„ triggerí•˜ëŠ” ê²½ìš° ë°œìƒ ê°€ëŠ¥. ë°ì´í„° ë¼ë²¨ë§ í’ˆì§ˆ ë¬¸ì œì´ë©°, ASA ìì²´ì˜ í•œê³„ê°€ ì•„ë‹˜.
- **ê°œì„  í­**: F1 0.53â†’0.62ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ë‚˜, ê°œë³„ caseì—ì„œëŠ” ì˜¤ë¥˜ ê°€ëŠ¥. ë” ì •ë°€í•œ ë¼ë²¨ë§ ë°ì´í„°ë¡œ ê°œì„  ì—¬ì§€ ìˆìŒ.

### ë°ëª¨: Baseline vs ASA

```
[TOOL] "Calculate the average rating for this product"
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âŒ  â†’  ASA: TRIGGERED âœ… (p=0.999, gate=+1)

[NO-TOOL] "Construct an analogy to explain a capacitor"
  Baseline: TRIGGERED âŒ     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âœ… (p=0.000, gate=-1)

[TOOL] "Calculate the month number for August 24"
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âŒ  â†’  ASA: TRIGGERED âœ… (p=0.998, gate=+1)

[NO-TOOL] "Provide an analogy to compare a computer to"
  Baseline: TRIGGERED âŒ     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âœ… (p=0.021, gate=-1)
```

---

## Liquid ê³µì‹ í¬ë§· ì‹¤í—˜

> ğŸ’¡ [Maxime Labonne](https://huggingface.co/mlabonne) (Liquid AI)ì˜ í”¼ë“œë°±ì„ ë°”íƒ•ìœ¼ë¡œ, Qwen-style ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ëŒ€ì‹  [Liquid ê³µì‹ Tool Use í¬ë§·](https://docs.liquid.ai/docs/key-concepts/tool-use)ì„ ì ìš©í•˜ì—¬ FPR ê°œì„  ê°€ëŠ¥ì„±ì„ ì‹¤í—˜.

ë…¸íŠ¸ë¶: [`ASA_LFM25_LiquidPrompt.ipynb`](ASA_LFM25_LiquidPrompt.ipynb)

### ë¬´ì—‡ì„ ë°”ê¿¨ë‚˜

| ìš”ì†Œ | ê¸°ì¡´ (Qwen-style) | ë³€ê²½ (Liquid ê³µì‹) |
|------|-------------------|-------------------|
| **ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸** | `"You are a helpful assistant with access to tools. When a user request requires using a tool, generate a tool call between <\|tool_call_start\|> and <\|tool_call_end\|> tokens. Available tools:\n" + json(indent=2)` | `"List of tools: " + json(compact)` |
| **í”„ë¡¬í”„íŠ¸ ê¸¸ì´** | 1,670 chars | 1,032 chars (**-38%**) |
| **ë„êµ¬ í˜¸ì¶œ ì§€ì‹œ** | ëª…ì‹œì  (`"generate a tool call between..."`) | âŒ ì—†ìŒ (ëª¨ë¸ ìì²´ í•™ìŠµ) |
| **JSON í¬ë§·** | Pretty-print (indent=2) | Compact (í•œ ì¤„) |

**ê°€ì„¤**: Qwen-styleì˜ ëª…ì‹œì  íŠ¸ë¦¬ê±° ì§€ì‹œ(`"generate a tool call between <|tool_call_start|> and <|tool_call_end|> tokens"`)ê°€ ëª¨ë¸ì„ "ë„êµ¬ í˜¸ì¶œ ëª¨ë“œ"ë¡œ ê³¼ì‰ ìœ ë„í•˜ì—¬ **FPRì„ ë†’ì´ëŠ” ì›ì¸**ì¼ ìˆ˜ ìˆë‹¤.

### ê²°ê³¼ ë¹„êµ: Qwen-style vs Liquid ê³µì‹

#### Baseline (ASA ì—†ìŒ)

| ë©”íŠ¸ë¦­ | Qwen-style | Liquid ê³µì‹ | ë³€í™” |
|--------|-----------|-------------|------|
| Precision | 0.4959 | 0.4927 | -0.6% |
| **Recall** | 0.5656 | **0.6312** | **+11.6%** â†‘ |
| **F1** | 0.5285 | **0.5534** | **+4.7%** â†‘ |
| **FPR** | 0.5750 | **0.6500** | **+13.0%** â†‘â†‘ |
| Accuracy | 0.4953 | 0.4906 | -0.9% |

#### ASA ì ìš©

| ë©”íŠ¸ë¦­ | Qwen-style | Liquid ê³µì‹ | ë³€í™” |
|--------|-----------|-------------|------|
| Precision | 0.7591 | 0.6476 | -14.7% â†“ |
| Recall | 0.5219 | 0.2125 | -59.3% â†“â†“ |
| F1 | 0.6185 | 0.3200 | -48.3% â†“â†“ |
| **FPR** | 0.1656 | **0.1156** | **-30.2%** â†“ |
| Accuracy | 0.6781 | 0.5484 | -19.1% â†“ |

#### íŒŒì´í”„ë¼ì¸ ì„¤ì • ë¹„êµ

| íŒŒë¼ë¯¸í„° | Qwen-style | Liquid ê³µì‹ |
|----------|-----------|-------------|
| **ìµœì  ë ˆì´ì–´ L\*** | **12** (GQA ë¸”ë¡) | **7** (LIV ë¸”ë¡) |
| Probe AUC at L* | 0.8856 | **0.8964** â†‘ |
| Î± (ìŠ¤í‹°ì–´ë§ ê°•ë„) | 1.0 | 1.0 |
| Ï„ (ì‹ ë¢° ì„ê³„ê°’) | 0.50 | 0.50 |
| Î² (MoV ê¸€ë¡œë²Œ ê°€ì¤‘ì¹˜) | 0.0 | 0.0 |

#### Ablation (Probe-level, TEST)

| ë³€í˜• | Qwen F1 | Liquid F1 | Qwen FPR | Liquid FPR |
|------|---------|-----------|----------|------------|
| **Full ASA** | 0.8054 | **0.8092** | 0.2375 | **0.2094** |
| No Gate | 0.6667 | 0.6667 | 1.0000 | 1.0000 |
| Global Only | 0.8054 | 0.8092 | 0.2375 | 0.2094 |
| Domain Only | 0.8054 | 0.8092 | 0.2375 | 0.2094 |

### ë¶„ì„: ì™œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì™”ë‚˜

**1. ê°€ì„¤ì€ í‹€ë ¸ë‹¤ â€” FPRì´ ì˜¤íˆë ¤ ì˜¬ë¼ê°”ë‹¤ (0.575 â†’ 0.650)**

Maximeì˜ í”¼ë“œë°±ê³¼ ë‹¬ë¦¬, Liquid ê³µì‹ í¬ë§·ìœ¼ë¡œ ë³€ê²½í•´ë„ baseline FPRì€ ê°œì„ ë˜ì§€ ì•Šì•˜ë‹¤. ì˜¤íˆë ¤ +7.5% ìƒìŠ¹. ì´ëŠ” **ë†’ì€ FPRì´ í”„ë¡¬í”„íŠ¸ ë¬¸ì œê°€ ì•„ë‹ˆë¼ LFM2.5 ëª¨ë¸ ìì²´ì˜ íŠ¹ì„±**ì„ì„ ì‹œì‚¬í•œë‹¤.

**2. í•˜ì§€ë§Œ ë‚´ë¶€ í‘œí˜„ì€ ë” ê¹¨ë—í•´ì¡Œë‹¤**

| ì§€í‘œ | Qwen-style | Liquid ê³µì‹ | ì˜ë¯¸ |
|------|-----------|-------------|------|
| Probe AUC | 0.8856 | **0.8964** | ë„êµ¬ ì˜ë„ íŒë…ì´ +1.2% ë” ì •í™• |
| L* ìœ„ì¹˜ | 12 (GQA) | **7 (LIV)** | ì‹ í˜¸ê°€ ë” ì´ˆê¸° ë ˆì´ì–´ì—ì„œ ê°ì§€ë¨ |
| Ablation F1 | 0.8054 | **0.8092** | Probe ìˆ˜ì¤€ ë¶„ë¥˜ ì„±ëŠ¥ ê°œì„  |
| Ablation FPR | 0.2375 | **0.2094** | Probe ìˆ˜ì¤€ ì˜¤íƒë¥  ê°œì„  |

ëª¨ë¸ì˜ "ìƒê°"ì€ ë” ê¹¨ë—í•´ì¡Œì§€ë§Œ, "í–‰ë™"ìœ¼ë¡œ ì´ì–´ì§€ì§€ ì•Šì•˜ë‹¤. ì´ê²ƒì´ ë°”ë¡œ ASA ë…¼ë¬¸ì—ì„œ ë§í•˜ëŠ” **í‘œí˜„-í–‰ë™ ê°„ê·¹ (Representation-Behavior Gap)**ì´ë‹¤.

**3. ASAì˜ ì—­í• ì´ ë‹¬ë¼ì¡Œë‹¤**

| ê´€ì  | Qwen-style ASA | Liquid ê³µì‹ ASA |
|------|----------------|-----------------|
| FPR ê°ì†Œ | 0.575 â†’ 0.166 (**-71%**) | 0.650 â†’ 0.116 (**-82%**) |
| Recall ìœ ì§€ | 0.566 â†’ 0.522 (**-8%**) | 0.631 â†’ 0.213 (**-66%**) |
| **íŠ¸ë ˆì´ë“œì˜¤í”„** | FPRâ†“ + Recall ì†Œí­â†“ | FPRâ†“â†“ + Recallâ†“â†“â†“ |

Liquid í¬ë§·ì—ì„œ ASAëŠ” **ì˜¤íƒ ì–µì œì—ëŠ” ê·¹ë„ë¡œ íš¨ê³¼ì ** (FPR 0.116ì€ ì „ì²´ ì‹¤í—˜ ì¤‘ ìµœì €)ì´ì§€ë§Œ, **ì •íƒê¹Œì§€ í•¨ê»˜ ì–µì œ**í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.

**4. L\* ì´ë™ì˜ ì˜ë¯¸ (12â†’7)**

L*ê°€ GQA ë¸”ë¡(layer 12)ì—ì„œ LIV ë¸”ë¡(layer 7)ìœ¼ë¡œ ì´ë™í•œ ê²ƒì€ ë§¤ìš° í¥ë¯¸ë¡œìš´ ë°œê²¬ì´ë‹¤:
- Qwen-style í”„ë¡¬í”„íŠ¸ì—ì„œëŠ” ë„êµ¬ ì˜ë„ ì‹ í˜¸ê°€ **í›„ë°˜ë¶€ ì–´í…ì…˜ ë¸”ë¡**ì—ì„œ í˜•ì„±
- Liquid ê³µì‹ í¬ë§·ì—ì„œëŠ” **ì´ˆê¸° ì»¨ë³¼ë£¨ì…˜ ë¸”ë¡**ì—ì„œ ì´ë¯¸ í˜•ì„±
- ì´ëŠ” ì§§ê³  ê¹”ë”í•œ í”„ë¡¬í”„íŠ¸ê°€ ëª¨ë¸ì˜ **ì´ˆê¸° ì •ë³´ ì²˜ë¦¬ë¥¼ ë³€í™”**ì‹œí‚´ì„ ì‹œì‚¬

### êµí›ˆ

| ë°œê²¬ | ì˜ë¯¸ |
|------|------|
| **ë†’ì€ FPRì€ ëª¨ë¸ íŠ¹ì„±** | LFM2.5ì˜ ê³¼ë‹¤ íŠ¸ë¦¬ê±°ëŠ” í”„ë¡¬í”„íŠ¸ ë¬¸ì œê°€ ì•„ë‹ˆë¼ ëª¨ë¸ ê³ ìœ  í–‰ë™ |
| **ASAëŠ” ì—¬ì „íˆ í•µì‹¬** | ì–´ë–¤ í”„ë¡¬í”„íŠ¸ì—ì„œë“  ASAê°€ FPRì„ -71~82% ì¤„ì¼ ìˆ˜ ìˆìŒ |
| **í”„ë¡¬í”„íŠ¸ëŠ” ë‚´ë¶€ í‘œí˜„ì— ì˜í–¥** | Liquid í¬ë§·ì´ probe AUCë¥¼ ê°œì„ í•˜ê³  L*ë¥¼ ì´ë™ì‹œí‚´ |
| **í‘œí˜„-í–‰ë™ ê°„ê·¹ì´ í•µì‹¬ ê³¼ì œ** | ëª¨ë¸ì´ "ì•Œë©´ì„œë„ ëª» í•˜ëŠ”" ë¬¸ì œê°€ í”„ë¡¬í”„íŠ¸ë³´ë‹¤ ê·¼ë³¸ì  |
| **Success Precision = 0** | ë‘ í¬ë§· ëª¨ë‘ ìœ íš¨ JSON ìƒì„± ë¶ˆê°€ â€” ëª¨ë¸ ìƒì„± ëŠ¥ë ¥ì˜ í•œê³„ |

> **ê²°ë¡ **: Maximeì˜ í”¼ë“œë°±ì€ **ë‚´ë¶€ í‘œí˜„ì„ ê°œì„ **í•˜ëŠ” ë°ëŠ” íš¨ê³¼ì ì´ì—ˆë‹¤ (AUCâ†‘, L\* ì´ë™). í•˜ì§€ë§Œ **baseline FPR ê°œì„ ì´ë¼ëŠ” ì›ë˜ ëª©í‘œëŠ” ë‹¬ì„±ë˜ì§€ ì•Šì•˜ë‹¤**. ì´ëŠ” LFM2.5ì˜ ë†’ì€ FPRì´ í”„ë¡¬í”„íŠ¸ í˜•ì‹ì´ ì•„ë‹Œ **ëª¨ë¸ ìì²´ì˜ ë„êµ¬ í˜¸ì¶œ í–‰ë™ íŠ¹ì„±**ì„ì„ í™•ì¸ì‹œì¼œì¤€ë‹¤. ASAëŠ” ì–´ë–¤ í”„ë¡¬í”„íŠ¸ì—ì„œë“  FPRì„ í™•ì‹¤íˆ ë‚®ì¶”ëŠ” í•µì‹¬ ì†”ë£¨ì…˜ìœ¼ë¡œ ë‚¨ëŠ”ë‹¤.

> **Ï„/Î± íŠœë‹** ([`ASA_LFM25_LiquidTuningTest.ipynb`](ASA_LFM25_LiquidTuningTest.ipynb)): ë…¼ë¬¸ ì„¤ì •(Ï„=0.60, Î±=4), ì•½í•œ ìŠ¤í‹°ì–´ë§(Î±<1), ì´‰ì§„ ëª¨ë“œ(Ï„=0.30), ìµœì†Œ ê°œì…(Ï„=0.90) ë“± **ì´ 16ê°€ì§€ ì¡°í•©**ì„ sweep. **ì–´ë–¤ ì„¤ì •ë„ Qwen-style + ASA (F1=0.62)ë¥¼ ë„˜ì§€ ëª»í•¨**. Liquid í¬ë§· ìµœì„ : F1=0.32 (Ï„=0.50, Î±=1). Baseline(F1=0.49)ë³´ë‹¤ ASA ì ìš© ì‹œ ì˜¤íˆë ¤ ì„±ëŠ¥ì´ í•˜ë½í•˜ì—¬, **Liquid í¬ë§·ì—ì„œëŠ” ASAë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ìµœì„ **. Qwen-style + ASAê°€ LFM2.5ì˜ ìµœì  ì¡°í•©ìœ¼ë¡œ í™•ì¸ë¨.

---

## ë…¼ë¬¸ ê²°ê³¼ì™€ ë¹„êµ

[ASA ë…¼ë¬¸](https://arxiv.org/abs/2602.04935) Tables 1â€“5ì˜ ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ì‚¬ìš©í•œ ì „ì²´ ëª¨ë¸ ë¹„êµ.

### Probe AUC: ì˜ë„ íŒë…ì„± (ë…¼ë¬¸ Table 1)

| ëª¨ë¸ | íŒŒë¼ë¯¸í„° | ë ˆì´ì–´ | L* | AUC | Shuffle AUC |
|------|---------|--------|-----|-----|-------------|
| Qwen2.5-0.5B (ë…¼ë¬¸) | 0.5B | 24 | 18 | **0.9994** | 0.4982 |
| Qwen2.5-1.5B (ë…¼ë¬¸) | 1.5B | 28 | 18 | **0.9996** | 0.4966 |
| Qwen2.5-8B (ë…¼ë¬¸) | 8B | 32 | 18 | **0.9989** | 0.4975 |
| **Qwen2.5-0.5B (ours)** | **0.5B** | **24** | **9** | **0.8734** | **0.5028** |
| **Qwen2.5-1.5B (ours)** | **1.5B** | **28** | **12** | **0.8849** | **0.4974** |
| **LFM2.5-1.2B (ours)** | **1.17B** | **16** | **12** | **0.8856** | â€” |
| **LFM2.5-1.2B Liquid (ours)** | **1.17B** | **16** | **7** | **0.8964** | â€” |

> ë…¼ë¬¸ ëª¨ë¸ë“¤ì€ ìì²´ ë°ì´í„°ì…‹ì—ì„œ ê±°ì˜ ì™„ë²½í•œ AUC (~0.999) ë‹¬ì„±. ìš°ë¦¬ì˜ ë…ë¦½ ì¬í˜„ â€” Qwen2.5-0.5B (0.873), Qwen2.5-1.5B (0.885), LFM2.5 (0.886) â€” ëª¨ë‘ ë™ì¼í•œ Alpaca í‚¤ì›Œë“œ í•„í„°ë§ìœ¼ë¡œ **0.87â€“0.89**ì— ìˆ˜ë ´. ëª¨ë¸ í¬ê¸°ë¥¼ 3ë°° (0.5Bâ†’1.5B) í‚¤ì›Œë„ AUCëŠ” +1.3%ë§Œ ê°œì„ ë˜ì–´, ì°¨ì´ì˜ ì›ì¸ì´ **ë°ì´í„°ì— ìˆìŒ** í™•ì¸.

### êµì°¨ ë„ë©”ì¸ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ (ë…¼ë¬¸ Table 2)

| | Code | Math | Search | Translation |
|--|------|------|--------|-------------|
| **ë…¼ë¬¸ (Qwen2.5-1.5B)** |
| Code | 1.00 | 0.17 | 0.37 | 0.42 |
| Math | 0.17 | 1.00 | 0.29 | 0.11 |
| Search | 0.37 | 0.29 | 1.00 | 0.03 |
| Translation | 0.42 | 0.11 | 0.03 | 1.00 |
| **Qwen2.5-0.5B (ours)** |
| Code | 1.00 | 0.05 | 0.005 | 0.06 |
| Math | 0.05 | 1.00 | 0.35 | 0.28 |
| Search | 0.005 | 0.35 | 1.00 | 0.40 |
| Translation | 0.06 | 0.28 | 0.40 | 1.00 |
| **Qwen2.5-1.5B (ours)** |
| Code | 1.00 | 0.04 | 0.009 | 0.12 |
| Math | 0.04 | 1.00 | 0.41 | 0.12 |
| Search | 0.009 | 0.41 | 1.00 | 0.10 |
| Translation | 0.12 | 0.12 | 0.10 | 1.00 |
| **LFM2.5 (ours)** |
| Code | 1.00 | -0.01 | 0.37 | 0.02 |
| Math | -0.01 | 1.00 | 0.30 | 0.26 |
| Search | 0.37 | 0.30 | 1.00 | 0.11 |
| Translation | 0.02 | 0.26 | 0.11 | 1.00 |

> ë„¤ ëª¨ë¸ ëª¨ë‘ ë„ë©”ì¸ë³„ ê¸°í•˜í•™ì  êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤Œ. ë‘ Qwen ëª¨ë¸ ëª¨ë‘ Codeê°€ ë‹¤ë¥¸ ë„ë©”ì¸ê³¼ ê±°ì˜ ì§êµ. Mathâ†”Searchê°€ í•˜ìœ„ê³µê°„ ê³µìœ .

### ì „ì²´ ë¹„êµ: ëª¨ë“  ëª¨ë¸ (ë…¼ë¬¸ Tables 4â€“5)

| ëª¨ë¸ | ë°©ë²• | Prec | Rec | **F1** | Acc | **FPR** |
|------|------|------|-----|--------|-----|---------|
| **Qwen2.5-1.5B** | Baseline | 0.4400 | 0.1146 | 0.1818 | 0.4844 | 0.1458 |
| (ë…¼ë¬¸) | Prompt (few-shot) | 0.4348 | 0.2083 | 0.2817 | â€” | 0.2708 |
| | LoRA (rank-16) | 0.5600 | 0.5833 | 0.5714 | â€” | 0.4583 |
| | Q-LoRA | 0.7328 | 0.3154 | 0.4696 | â€” | 0.1193 |
| | **ASA Î±=4.0** | **0.8718** | **0.3542** | **0.5037** | **0.6510** | **0.0521** |
| **LLaMA-8B** | Baseline | 0.8407 | 0.4378 | 0.5759 | 0.6779 | 0.0839 |
| (ë…¼ë¬¸) | Prompt-only | 0.8627 | 0.4988 | 0.6238 | 0.7159 | 0.0829 |
| | **ASA (best)** | **0.9079** | **0.7188** | **0.8023** | **0.8229** | **0.0700** |
| **Qwen2.5-0.5B** | Baseline | 0.5821 | 0.1219 | 0.2016 | 0.5172 | 0.0875 |
| (ours) | **ASA Î±=1.0** | **0.6176** | **0.1313** | **0.2165** | **0.5250** | **0.0813** |
| **Qwen2.5-1.5B** | Baseline | 0.7857 | 0.4125 | 0.5410 | 0.6500 | 0.1125 |
| (ours) | **ASA Î±=1.0** | 0.7857 | 0.4125 | 0.5410 | 0.6500 | 0.1125 |
| **LFM2.5-1.2B** | Baseline | 0.4959 | 0.5656 | 0.5285 | 0.4953 | 0.5750 |
| (ours, Qwen-style) | **ASA Î±=1.0** | **0.7591** | **0.5219** | **0.6185** | **0.6781** | **0.1656** |
| **LFM2.5-1.2B** | Baseline | 0.4927 | 0.6312 | 0.5534 | 0.4906 | 0.6500 |
| (ours, Liquid) | **ASA Î±=1.0** | 0.6476 | 0.2125 | 0.3200 | 0.5484 | **0.1156** |

### í•µì‹¬ ê´€ì°°

**1. ì •ë°˜ëŒ€ì˜ ë² ì´ìŠ¤ë¼ì¸ ë¬¸ì œ:**

| ëª¨ë¸ | ë² ì´ìŠ¤ë¼ì¸ ë¬¸ì œ | ASA íš¨ê³¼ |
|------|---------------|---------|
| Qwen2.5-1.5B (ë…¼ë¬¸) | **ê³¼ì†Œ íŠ¸ë¦¬ê±°** (Recall=0.11) | íŠ¸ë¦¬ê±° ì´‰ì§„ â†‘ |
| LLaMA-8B (ë…¼ë¬¸) | ë³´í†µ (Recall=0.44) | P, R ëª¨ë‘ ê°œì„  |
| Qwen2.5-0.5B (ours) | **ê³¼ì†Œ íŠ¸ë¦¬ê±°** (Recall=0.12) | íš¨ê³¼ ë¯¸ë¯¸ (+7%) |
| Qwen2.5-1.5B (ours) | **ì´ë¯¸ ì–‘í˜¸** (F1=0.54) | **íš¨ê³¼ ì—†ìŒ (0%)** |
| LFM2.5-1.2B Qwen (ours) | **ê³¼ë‹¤ íŠ¸ë¦¬ê±°** (FPR=0.58) | ì˜¤ì‘ë™ ì–µì œ â†“ |
| LFM2.5-1.2B Liquid (ours) | **ê³¼ë‹¤ íŠ¸ë¦¬ê±°** (FPR=0.65) | FPR ìµœì €ì¹˜ (0.116), Recallâ†“â†“ |

> ìš°ë¦¬ì˜ Qwen2.5-1.5B ë² ì´ìŠ¤ë¼ì¸ (F1=0.54)ì´ **ë…¼ë¬¸ì˜ ASA ê²°ê³¼ (F1=0.50)ë³´ë‹¤ ì´ë¯¸ ë†’ìŒ**. ìš°ë¦¬ í”„ë¡¬í”„íŠ¸/ë°ì´í„° êµ¬ì„±ì´ ì´ë¯¸ ë„êµ¬ í˜¸ì¶œì„ ì˜ ìœ ë„í•˜ì—¬ ASAê°€ í•  ì¼ì´ ì—†ìŒ. ë…¼ë¬¸ì˜ ê·¹ì  ê°œì„  (+177%)ì€ ê·¹ë„ë¡œ ì•½í•œ ë² ì´ìŠ¤ë¼ì¸ (Recall=0.11)ì—ì„œ ì‹œì‘.

**2. ìƒëŒ€ ê°œì„ ìœ¨:**

| ê°œì„  ì§€í‘œ | Qwen2.5-1.5B (ë…¼ë¬¸) | LLaMA-8B (ë…¼ë¬¸) | Qwen2.5-0.5B (ours) | Qwen2.5-1.5B (ours) | LFM2.5 Qwen (ours) | LFM2.5 Liquid (ours) |
|----------|-------------|----------|-------------|-------------|------------|
| Î”F1 (ìƒëŒ€) | +177% | +39% | **+7%** | **0%** | **+17%** | **-39%** |
| Î”FPR (ìƒëŒ€) | -64% | -17% | **-7%** | **0%** | **-71%** | **-82%** |
| Î”Precision | +98% | +8% | **+6%** | **0%** | **+53%** | +31% |

> ASAì˜ íš¨ê³¼ëŠ” **ë² ì´ìŠ¤ë¼ì¸ í’ˆì§ˆì— ë°˜ë¹„ë¡€**: ì•½í•œ ë² ì´ìŠ¤ë¼ì¸ì—ì„œëŠ” ê·¹ì  ê°œì„ , ì´ë¯¸ ì˜ ì‘ë™í•˜ëŠ” ëª¨ë¸ì—ì„œëŠ” íš¨ê³¼ ì—†ìŒ.

**3. í›„íŠ¸ë¦¬ê±° ìœ íš¨ì„±:**

| ëª¨ë¸ | JSON Valid | Schema OK | Args OK |
|------|-----------|-----------|---------|
| Qwen2.5-1.5B ASA (ë…¼ë¬¸) | 0.8800 | 0.6923 | 0.8700 |
| Qwen2.5-0.5B ASA (ours) | 0.0441 | 0.0147 | 0.0441 |
| Qwen2.5-1.5B ASA (ours) | **0.3333** | **0.3214** | **0.0655** |
| LFM2.5-1.2B ASA (ours) | 0.0000 | 0.0000 | 0.0000 |

> Qwen2.5-1.5BëŠ” 33% í™•ë¥ ë¡œ ìœ íš¨ JSON ìƒì„± â€” 0.5Bë³´ë‹¤ 7.5ë°° ë‚˜ìŒ. í•˜ì§€ë§Œ ë…¼ë¬¸ì˜ 88%ì—ëŠ” ë¯¸ë‹¬. baseline=ASA ê²°ê³¼ì™€ í•©ì³ë³´ë©´, **ë°ì´í„°/í”„ë¡¬í”„íŠ¸ ì°¨ì´**ê°€ í•µì‹¬ ìš”ì¸.

### ì£¼ì˜ì‚¬í•­

- **ë°ì´í„° ì°¨ì´**: ë…¼ë¬¸ì€ ë¹„ê³µê°œ ë°ì´í„°ì…‹(REST/MOV/CAL)ì„ Alpaca + Natural Questionsì—ì„œ ë¹„ê³µê°œ í•„í„°ë§ ê·œì¹™ìœ¼ë¡œ êµ¬ì¶•. ìš°ë¦¬ëŠ” Alpacaë§Œìœ¼ë¡œ í‚¤ì›Œë“œ íœ´ë¦¬ìŠ¤í‹± ë¼ë²¨ë§ (AUC 0.87 vs 0.999).
- **ì½”ë“œ ë¹„ê³µê°œ**: ë…¼ë¬¸ì˜ ì „ì²˜ë¦¬, ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸, ì •í™•í•œ í”„ë¡œí† ì½œì´ ê³µê°œë˜ì§€ ì•Šì•„ ì •í™•í•œ ì¬í˜„ ë¶ˆê°€ëŠ¥.
- **ëª¨ë¸ ì•„í‚¤í…ì²˜**: LFM2.5ëŠ” ASAë¡œ í…ŒìŠ¤íŠ¸ëœ ìµœì´ˆì˜ ë¹„-Transformer ëª¨ë¸. í•˜ì´ë¸Œë¦¬ë“œ LIV+GQA ì•„í‚¤í…ì²˜.
- **Î± ë¯¼ê°ë„**: LFM2.5ëŠ” ìŠ¤í‹°ì–´ë§ì— ë” ë¯¼ê° (Î±=1 vs ë…¼ë¬¸ì˜ Î±=4).
- **ëª¨ë¸ ìš©ëŸ‰**: Qwen2.5-0.5BëŠ” ë„êµ¬ í˜¸ì¶œ ìƒì„± ëŠ¥ë ¥ ë¶€ì¡± â€” ASAë¡œ ì—†ëŠ” ëŠ¥ë ¥ì„ ë§Œë“¤ ìˆ˜ ì—†ìŒ.

---

## Qwen2.5-0.5B ì¬í˜„ ë¶„ì„

[ASA ë…¼ë¬¸](https://arxiv.org/abs/2602.04935) Table 1 ê²°ê³¼ë¥¼ **Qwen2.5-0.5B-Instruct**ë¡œ ë…ë¦½ ì¬í˜„. LFM2.5ì™€ ë™ì¼í•œ Alpaca í•„í„°ë§ íŒŒì´í”„ë¼ì¸ ì‚¬ìš©. ë…¸íŠ¸ë¶: [`ASA_Qwen05B_Reproduction.ipynb`](ASA_Qwen05B_Reproduction.ipynb).

### Probe Sweep ê²°ê³¼ (ì „ì²´ 24 ë ˆì´ì–´)

| ë ˆì´ì–´ | AUC | Acc | | ë ˆì´ì–´ | AUC | Acc |
|--------|------|------|-|--------|------|------|
| 0 | 0.7484 | 0.7031 | | 12 | 0.8545 | 0.7969 |
| 1 | 0.8130 | 0.7406 | | 13 | 0.8526 | 0.7875 |
| 2 | 0.8345 | 0.7844 | | 14 | 0.8566 | 0.7906 |
| 3 | 0.8182 | 0.7344 | | 15 | 0.8480 | 0.7937 |
| 4 | 0.8677 | 0.7562 | | 16 | 0.8622 | 0.8031 |
| 5 | 0.8699 | 0.7906 | | 17 | 0.8555 | 0.7844 |
| 6 | 0.8674 | 0.7656 | | 18 | 0.8580 | 0.7875 |
| 7 | 0.8586 | 0.7750 | | 19 | 0.8461 | 0.7594 |
| 8 | 0.8607 | 0.7625 | | 20 | 0.8278 | 0.7531 |
| **9** | **0.8734** | **0.8000** | | 21 | 0.8196 | 0.7375 |
| 10 | 0.8600 | 0.7937 | | 22 | 0.8227 | 0.7562 |
| 11 | 0.8596 | 0.7906 | | 23 | 0.8170 | 0.7594 |

**L\* = 9** (ì¤‘ê°„ ë ˆì´ì–´, ë…¼ë¬¸ì˜ L\*=18ê³¼ ë‹¤ë¦„). AUCê°€ ë ˆì´ì–´ 4â€“9ì—ì„œ ì •ì ì„ ì°ê³  ì ì§„ì ìœ¼ë¡œ ê°ì†Œ â€” ë…¼ë¬¸ì˜ ì „ ë ˆì´ì–´ 0.999 ìœ ì§€ íŒ¨í„´ê³¼ ê·¼ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì¢… ëª¨ì–‘ ë¶„í¬.

### ìŠ¤í‹°ì–´ë§ ë²¡í„° ì½”ì‚¬ì¸

| ë„ë©”ì¸ | cos(v_d, v_global) |
|--------|-------------------|
| math | 0.7097 |
| code | 0.3755 |
| search | 0.7326 |
| translation | 0.6774 |

Codeê°€ ê¸€ë¡œë²Œ ë²¡í„°ì™€ ê°€ì¥ ë‚®ì€ ì •ë ¬ (0.38) â€” codeê°€ ê°€ì¥ ì˜ë¯¸ì ìœ¼ë¡œ ë…íŠ¹í•œ ë„ë©”ì¸.

### ë¼ìš°í„° & í”„ë¡œë¸Œ ì •í™•ë„

| êµ¬ì„±ìš”ì†Œ | í•™ìŠµ Acc | ê²€ì¦ Acc |
|---------|---------|---------|
| ë¼ìš°í„° (4-class) | 1.0000 | 0.7219 |
| í”„ë¡œë¸Œ: math | 1.0000 | 0.9000 |
| í”„ë¡œë¸Œ: code | 1.0000 | 0.6875 |
| í”„ë¡œë¸Œ: search | 1.0000 | 0.9375 |
| í”„ë¡œë¸Œ: translation | 1.0000 | 1.0000 |

> ë¼ìš°í„° ê³¼ì í•© (í•™ìŠµ 100% â†’ ê²€ì¦ 72%). Code í”„ë¡œë¸Œê°€ ê°€ì¥ ì•½í•¨ (ê²€ì¦ 69%) â€” Alpaca í‚¤ì›Œë“œ ê¸°ë°˜ ì½”ë“œ ë¼ë²¨ì˜ ë…¸ì´ì¦ˆ ë•Œë¬¸.

### í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

| íŒŒë¼ë¯¸í„° | ì„ íƒê°’ | ë…¼ë¬¸ (Qwen 1.5B) |
|---------|-------|-----------------|
| Î± | 1.0 | 4.0 |
| Ï„ | 0.50 | 0.60 |
| Î² | 0.0 | â€” |

> ëª¨ë“  Î±ê°’ (1â€“20)ì—ì„œ ë™ì¼í•œ F1=0.7732 â€” hidden-state ë ˆë²¨ í‰ê°€ê°€ ì´ë¯¸ í¬í™”. ìŠ¤í‹°ì–´ë§ ê°•ë„ Î±ëŠ” ìƒì„± í‰ê°€ì—ì„œë§Œ ì˜ë¯¸ ìˆìŒ.

### TEST ê²°ê³¼ (640 ìƒ˜í”Œ)

| ë©”íŠ¸ë¦­ | Baseline | ASA | ë³€í™” |
|--------|----------|-----|------|
| **Precision** | 0.5821 | **0.6176** | +6.1% |
| **Recall** | 0.1219 | **0.1313** | +7.7% |
| **F1** | 0.2016 | **0.2165** | +7.4% |
| **FPR** | 0.0875 | **0.0813** | -7.1% |
| **Accuracy** | 0.5172 | **0.5250** | +1.5% |

### ë„ë©”ì¸ë³„ ASA ê²°ê³¼

| ë„ë©”ì¸ | Precision | Recall | F1 | FPR |
|--------|-----------|--------|-----|-----|
| math | 0.5000 | 0.1875 | 0.2727 | 0.1875 |
| code | 0.6000 | 0.1500 | 0.2400 | 0.1000 |
| search | 0.8000 | 0.1500 | 0.2526 | 0.0375 |
| translation | 1.0000 | 0.0375 | 0.0723 | 0.0000 |

> Translationì€ ì™„ë²½í•œ precisionì´ì§€ë§Œ recallì´ ê±°ì˜ 0 â€” 0.5B ëª¨ë¸ì€ ë²ˆì—­ ì¿¼ë¦¬ì— `<functioncall>`ì„ ASA ìŠ¤í‹°ì–´ë§ìœ¼ë¡œë„ ê±°ì˜ ìƒì„±í•˜ì§€ ì•ŠìŒ.

### Ablation ì—°êµ¬

| ë³€í˜• | F1 | Prec | Rec | FPR |
|------|-----|------|-----|-----|
| **Full ASA** | **0.7870** | 0.7774 | 0.7969 | 0.2281 |
| No Gate | 0.6667 | 0.5000 | 1.0000 | **1.0000** |
| Global Only | 0.7870 | 0.7774 | 0.7969 | 0.2281 |
| Domain Only | 0.7870 | 0.7774 | 0.7969 | 0.2281 |

> ê²Œì´íŠ¸ê°€ í•µì‹¬ â€” ì—†ìœ¼ë©´ (No Gate) FPRì´ 100%ë¡œ ê¸‰ë“±. Globalê³¼ Domain-onlyê°€ ë™ì¼í•œ ì„±ëŠ¥ â†’ ì´ ëª¨ë¸ ìŠ¤ì¼€ì¼ì—ì„œëŠ” ê¸€ë¡œë²Œ ë°©í–¥ì´ ëŒ€ë¶€ë¶„ì˜ ìŠ¤í‹°ì–´ë§ ì‹ í˜¸ë¥¼ ì´ë¯¸ í¬ì°©.

### ë°ëª¨ ì¶œë ¥

```
[TOOL] "Calculate the monthly cost of a house..."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ (p=0.995, gate=+1)

[TOOL] "How many teaspoons are in 1/4 cup?"
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ (p=0.969, gate=+1)

[NO-TOOL] "Construct an analogy to explain the function of a capacitor."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ (p=0.000, gate=-1)

[TOOL] "Create a program to calculate the area of a triangle..."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ (p=1.000, gate=+1)

[TOOL] "Calculate the average rating for this product..."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨     â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ (p=0.998, gate=+1)
```

> í”„ë¡œë¸ŒëŠ” ë„êµ¬ ì˜ë„ë¥¼ ì •í™•íˆ ì‹ë³„ (pâ‰ˆ1.0 for tool, pâ‰ˆ0.0 for non-tool)í•˜ê³  ê²Œì´íŠ¸ë„ ì˜¬ë°”ë¥´ê²Œ ì‘ë™ (+1/-1)í•˜ì§€ë§Œ, **ì‹¤ì œ ìƒì„±ì€ ë³€í™” ì—†ìŒ**. ì´ëŠ” ë…¼ë¬¸ì˜ í‘œí˜„-í–‰ë™ ê°„ê·¹(Â§B.1)ì„ ì…ì¦ â€” ì˜ë„ëŠ” íŒë… ê°€ëŠ¥í•˜ì§€ë§Œ, ì´ ëª¨ë¸ ê·œëª¨ì—ì„œëŠ” í–‰ë™ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒ.

### ë…¼ë¬¸ê³¼ì˜ ì°¨ì´ ì›ì¸ ë¶„ì„

| ìš”ì¸ | ì˜í–¥ë„ | ì„¤ëª… |
|------|--------|------|
| **ë°ì´í„° (ë¹„ê³µê°œ)** | â­â­â­ | ë…¼ë¬¸ì€ ë¹„ê³µê°œ REST/MOV/CAL ë°ì´í„°ì…‹ì— `<functioncall>` ë§ˆì»¤ ê²€ì¦ ì‚¬ìš©; ìš°ë¦¬ëŠ” Alpaca í‚¤ì›Œë“œ íœ´ë¦¬ìŠ¤í‹± |
| **Natural Questions** | â­â­â­ | ë…¼ë¬¸ì€ ê²€ìƒ‰ ë„ë©”ì¸ì— NQ ì‚¬ìš©; ìš°ë¦¬ëŠ” Alpacaë§Œ ì‚¬ìš© |
| **ë¼ë²¨ ê²€ì¦** | â­â­â­ | ë…¼ë¬¸ì€ ëª¨ë¸ ì¶œë ¥ ë§ˆì»¤ë¡œ ë¼ë²¨ ê²€ì¦ â†’ ëª¨ë¸ì— ìµœì í™”ëœ ë°ì´í„° |
| **ëª¨ë¸ ìš©ëŸ‰** | â­â­ | 0.5BëŠ” `<functioncall>` ìƒì„± ëŠ¥ë ¥ ë¶€ì¡± (ë…¼ë¬¸ì€ 0.5Bì˜ F1 ë¯¸ë³´ê³ ) |
| **ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸** | â­ | ì •í™•í•œ í”„ë¡¬í”„íŠ¸ í˜•ì‹ ë¹„ê³µê°œ |
| **ë„êµ¬ ì •ì˜** | â­ | ë„êµ¬ ê°œìˆ˜ ë° ìŠ¤í‚¤ë§ˆ ë¹„ê³µê°œ |

> ë…¼ë¬¸ì€ **Qwen2.5-0.5Bì˜ ìƒì„± ê²°ê³¼(F1/FPR)ë¥¼ ë³´ê³ í•˜ì§€ ì•ŠìŒ** â€” Table 1ì˜ Probe AUCë§Œ ë³´ê³ . ìš°ë¦¬ ì‹¤í—˜ìœ¼ë¡œ ê·¸ ì´ìœ ê°€ ë°í˜€ì§: 0.5B ëª¨ë¸ì€ `<functioncall>` í† í°ì„ ì•ˆì •ì ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ì—†ì–´, í‘œí˜„ ìˆ˜ì¤€ì—ì„œ ì˜ë„ ê°ì§€ì— ì„±ê³µí•´ë„ í–‰ë™ ìˆ˜ì¤€ì—ì„œ ASA ìŠ¤í‹°ì–´ë§ì´ ë¹„íš¨ê³¼ì .

---

## Qwen2.5-1.5B ì¬í˜„ ë¶„ì„

ë…¼ë¬¸ì˜ **ë©”ì¸ ëª¨ë¸**ì¸ Qwen2.5-1.5B-Instructë¥¼ ë…ë¦½ ì¬í˜„. ë…¸íŠ¸ë¶: [`ASA_Qwen15B_Reproduction.ipynb`](ASA_Qwen15B_Reproduction.ipynb).

> âš ï¸ **í•µì‹¬ ë°œê²¬: ASAê°€ ë² ì´ìŠ¤ë¼ì¸ê³¼ ì™„ì „íˆ ë™ì¼í•œ ê²°ê³¼ë¥¼ ìƒì„±.** ìš°ë¦¬ ë² ì´ìŠ¤ë¼ì¸ì´ ì´ë¯¸ ë…¼ë¬¸ì˜ ASA ê²°ê³¼ë¥¼ ì´ˆê³¼ (F1=0.54 vs 0.50)í•˜ì—¬ ê°œì„  ì—¬ì§€ê°€ ì—†ê¸° ë•Œë¬¸ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ. ë°ì´í„°/í”„ë¡¬í”„íŠ¸ ì°¨ì´ ë˜ëŠ” Î±=1ì—ì„œì˜ ìŠ¤í‹°ì–´ë§ êµ¬í˜„ ë¬¸ì œ ê°€ëŠ¥ì„±.

### Probe Sweep ê²°ê³¼ (ì „ì²´ 28 ë ˆì´ì–´)

| ë ˆì´ì–´ | AUC | Acc | | ë ˆì´ì–´ | AUC | Acc |
|--------|------|------|-|--------|------|------|
| 0 | 0.7655 | 0.6906 | | 14 | 0.8571 | 0.7781 |
| 1 | 0.8190 | 0.7281 | | 15 | 0.8727 | 0.7906 |
| 2 | 0.8419 | 0.7469 | | 16 | 0.8609 | 0.7875 |
| 3 | 0.8437 | 0.7500 | | 17 | 0.8560 | 0.7969 |
| 4 | 0.8380 | 0.7469 | | 18 | 0.8318 | 0.7375 |
| 5 | 0.8293 | 0.7500 | | 19 | 0.8245 | 0.7438 |
| 6 | 0.8248 | 0.7469 | | 20 | 0.8224 | 0.7406 |
| 7 | 0.8336 | 0.7406 | | 21 | 0.8259 | 0.7344 |
| 8 | 0.8536 | 0.7562 | | 22 | 0.8162 | 0.7219 |
| 9 | 0.8337 | 0.7594 | | 23 | 0.8246 | 0.7344 |
| 10 | 0.8475 | 0.7719 | | 24 | 0.8289 | 0.7469 |
| 11 | 0.8629 | 0.7719 | | 25 | 0.8250 | 0.7188 |
| **12** | **0.8849** | **0.8063** | | 26 | 0.8482 | 0.7375 |
| 13 | 0.8652 | 0.7844 | | 27 | 0.8386 | 0.7500 |

**L\* = 12** (LFM2.5ì™€ ë™ì¼, ë…¼ë¬¸ì˜ L\*=18ê³¼ ë‹¤ë¦„). 0.5Bì™€ ë™ì¼í•œ ì¢… ëª¨ì–‘ ë¶„í¬.

### AUC ìˆ˜ë ´ í™•ì¸

| ëª¨ë¸ | L* | Best AUC | ë…¼ë¬¸ AUC |
|------|-----|----------|----------|
| Qwen2.5-0.5B (ours) | 9 | 0.8734 | 0.9994 |
| **Qwen2.5-1.5B (ours)** | **12** | **0.8849** | **0.9996** |
| LFM2.5-1.2B (ours) | 12 | 0.8856 | â€” |

> ëª¨ë¸ í¬ê¸°ë¥¼ 3ë°° í‚¤ì›Œë„ (0.5Bâ†’1.5B) AUCê°€ **+1.3%** (0.8734â†’0.8849)ë§Œ ê°œì„ . ì„¸ ëª¨ë¸ ëª¨ë‘ 0.87â€“0.89ì— ìˆ˜ë ´ â€” **ë°ì´í„° í’ˆì§ˆì´ ìƒí•œì„ ì„ ê²°ì •**.

### ìŠ¤í‹°ì–´ë§ ë²¡í„° ì½”ì‚¬ì¸

| ë„ë©”ì¸ | cos(v_d, v_global) |
|--------|-------------------|
| math | 0.7304 |
| code | 0.3674 |
| search | 0.7400 |
| translation | 0.4870 |

### ë¼ìš°í„° & í”„ë¡œë¸Œ ì •í™•ë„

| êµ¬ì„±ìš”ì†Œ | í•™ìŠµ Acc | ê²€ì¦ Acc |
|---------|---------|----------|
| ë¼ìš°í„° (4-class) | 1.0000 | 0.7500 |
| í”„ë¡œë¸Œ: math | 1.0000 | 0.8875 |
| í”„ë¡œë¸Œ: code | 1.0000 | 0.6875 |
| í”„ë¡œë¸Œ: search | 1.0000 | 0.9125 |
| í”„ë¡œë¸Œ: translation | 1.0000 | 1.0000 |

### í•˜ì´í¼íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ì„ íƒê°’ | ë…¼ë¬¸ (Qwen 1.5B) |
|---------|-------|------------------|
| Î± | 1.0 | 4.0 |
| Ï„ | 0.50 | 0.60 |
| Î² | 0.0 | â€” |

> HP sweepì—ì„œ Î±=1 ì„ íƒ, ë…¼ë¬¸ì€ Î±=4 ì‚¬ìš©. ìš°ë¦¬ ë² ì´ìŠ¤ë¼ì¸ì´ ì´ë¯¸ ê°•í•´ì„œ Î±=4ë¡œë„ ê²°ê³¼ ë³€í™” ì—†ì„ ê°€ëŠ¥ì„±.

### TEST ê²°ê³¼ (640 ìƒ˜í”Œ)

| ë©”íŠ¸ë¦­ | Baseline | ASA | ë³€í™” |
|--------|----------|-----|------|
| **Precision** | 0.7857 | 0.7857 | **0%** |
| **Recall** | 0.4125 | 0.4125 | **0%** |
| **F1** | 0.5410 | 0.5410 | **0%** |
| **FPR** | 0.1125 | 0.1125 | **0%** |
| **Accuracy** | 0.6500 | 0.6500 | **0%** |

> **ASA = Baseline (ì „ ë©”íŠ¸ë¦­ ë™ì¼).** ê°€ëŠ¥í•œ ì›ì¸: (1) ì´ë¯¸ ê°•í•œ ë² ì´ìŠ¤ë¼ì¸ì—ì„œ Î±=1 ìŠ¤í‹°ì–´ë§ì€ í•œê³„ íš¨ê³¼ ì—†ìŒ, (2) ë…¼ë¬¸ê³¼ ë‹¤ë¥¸ ë°ì´í„°/í”„ë¡¬í”„íŠ¸ê°€ ê·¼ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ë™ì‘ ì˜ì—­ì„ ë§Œë“¦, (3) ë…¼ë¬¸ì˜ Î±=4ê°€ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë‚˜ validation HP sweepì—ì„œ ì„ íƒë˜ì§€ ì•ŠìŒ.

### ë² ì´ìŠ¤ë¼ì¸ ë¹„êµ: ìš°ë¦¬ vs ë…¼ë¬¸

| ë©”íŠ¸ë¦­ | ë…¼ë¬¸ 1.5B Baseline | ìš°ë¦¬ 1.5B Baseline | ìš°ë¦¬ì˜ ìš°ìœ„ |
|--------|--------------------|--------------------|------------|
| Precision | 0.4400 | **0.7857** | +79% |
| Recall | 0.1146 | **0.4125** | +260% |
| F1 | 0.1818 | **0.5410** | +198% |
| FPR | 0.1458 | **0.1125** | -23% |

> ìš°ë¦¬ ë² ì´ìŠ¤ë¼ì¸ F1 (0.54)ì´ **ë…¼ë¬¸ì˜ ASA ê²°ê³¼ (0.50)ë¥¼ ì´ˆê³¼**. ìš°ë¦¬ í”„ë¡¬í”„íŠ¸ì™€ ë°ì´í„° êµ¬ì„±ì´ Qwen2.5-1.5Bì˜ ë„êµ¬ í˜¸ì¶œì„ ì´ë¯¸ ì˜ ìœ ë„í•˜ì—¬ ASAê°€ ë¶ˆí•„ìš”. ë…¼ë¬¸ì˜ ê·¹ì  ê°œì„  (+177%)ì€ ìš°ë¦¬ íŒŒì´í”„ë¼ì¸ì—ì„œ ì¬í˜„ë˜ì§€ ì•ŠëŠ” ê·¹ë„ë¡œ ì•½í•œ ë² ì´ìŠ¤ë¼ì¸ì— ì˜ì¡´.

### ë„ë©”ì¸ë³„ ASA ê²°ê³¼

| ë„ë©”ì¸ | Precision | Recall | F1 | FPR | JSON Valid |
|--------|-----------|--------|-----|-----|------------|
| math | 0.7222 | 0.6500 | 0.6842 | 0.2500 | 0.2500 |
| code | 0.3636 | 0.1000 | 0.1569 | 0.1750 | 0.3182 |
| search | 0.9091 | 0.2500 | 0.3922 | 0.0250 | 0.2727 |
| translation | 1.0000 | 0.6500 | 0.7879 | 0.0000 | 0.4808 |

> Translationì´ ê°€ì¥ ê°•ë ¥ (F1=0.79, FPR 0%) ë° JSON ìœ íš¨ì„± ìµœê³  (48%). CodeëŠ” ëª¨ë“  ëª¨ë¸ì—ì„œ ì—¬ì „íˆ ìµœì•½.

### Ablation ì—°êµ¬

| ë³€í˜• | F1 | Prec | Rec | FPR |
|------|-----|------|-----|-----|
| **Full ASA** | **0.7969** | 0.7848 | 0.8094 | 0.2219 |
| No Gate | 0.6667 | 0.5000 | 1.0000 | **1.0000** |
| Global Only | 0.7969 | 0.7848 | 0.8094 | 0.2219 |
| Domain Only | 0.7969 | 0.7848 | 0.8094 | 0.2219 |

### ë°ëª¨ ì¶œë ¥

```
[TOOL] "Calculate the monthly cost of a house..."
  Baseline: TRIGGERED âœ…     â†’  ASA: TRIGGERED âœ… (p=0.991, gate=+1)

[TOOL] "How many teaspoons are in 1/4 cup?"
  Baseline: TRIGGERED âœ…     â†’  ASA: TRIGGERED âœ… (p=0.970, gate=+1)

[NO-TOOL] "Construct an analogy to explain the function of a capacitor."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âœ…   â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âœ… (p=0.000, gate=-1)

[NO-TOOL] "Rewrite the sentence to make it more succinct..."
  Baseline: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âœ…   â†’  ASA: íŠ¸ë¦¬ê±° ì•ˆ ë¨ âš ï¸ (p=0.982, gate=+1)

[TOOL] "Create a program to calculate the area of a triangle..."
  Baseline: TRIGGERED âœ…     â†’  ASA: TRIGGERED âœ… (p=0.963, gate=+1)
```

> 0.5Bì™€ ë‹¬ë¦¬ 1.5B ë² ì´ìŠ¤ë¼ì¸ì€ ì´ë¯¸ tool ì¿¼ë¦¬ì—ì„œ ì •í™•íˆ íŠ¸ë¦¬ê±°. ASAëŠ” ëª¨ë“  ê²½ìš°ì—ì„œ ë² ì´ìŠ¤ë¼ì¸ê³¼ ë™ì¼í•˜ê²Œ ë™ì‘. ì£¼ëª©: í”„ë¡œë¸Œê°€ NO-TOOL ì¬ì‘ì„± ì¿¼ë¦¬ì— p=0.982 (gate=+1) ë¶€ì—¬ â€” ì˜¤ë¶„ë¥˜ì´ë‚˜ ì¶œë ¥ì— ì˜í–¥ ì—†ìŒ.

## ASA ì‘ë™ ì›ë¦¬

```mermaid
graph LR
    A[ì…ë ¥] --> B[ëª¨ë¸ ìˆœì „íŒŒ]
    B --> C{ë ˆì´ì–´ L*=12}
    C --> D[ë¼ìš°í„°: ë„ë©”ì¸ ë¶„ë¥˜]
    D --> E[í”„ë¡œë¸Œ: ë„êµ¬ ì˜ë„ ì ìˆ˜]
    E --> F{3ì§„ ê²Œì´íŠ¸}
    F -->|p â‰¥ Ï„: +1| G[+Î±v ì£¼ì… â†’ ë„êµ¬ í˜¸ì¶œ ì´‰ì§„]
    F -->|p â‰¤ 1-Ï„: -1| H[-Î±v ì£¼ì… â†’ ë„êµ¬ í˜¸ì¶œ ì–µì œ]
    F -->|ê·¸ ì™¸: 0| I[ê°œì… ì—†ìŒ]
    G --> J[ìƒì„± ê³„ì†]
    H --> J
    I --> J
```

**í•µì‹¬ í†µì°°:** LLMì€ ì¢…ì¢… ë„êµ¬ ì‚¬ìš© ì˜ë„ë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ í‘œí˜„í•˜ì§€ë§Œ ì‹¤í–‰í•˜ì§€ ëª»í•˜ëŠ” "Lazy Agent" í˜„ìƒì´ ìˆìŠµë‹ˆë‹¤. ASAëŠ” ìˆ¨ê²¨ì§„ ìƒíƒœë¥¼ ë„êµ¬ í˜¸ì¶œ ë°©í–¥ìœ¼ë¡œ ì‚´ì§ ë°€ì–´ì¤Œìœ¼ë¡œì¨ ì´ í‘œí˜„-í–‰ë™ ê°„ê·¹ì„ í•´ì†Œí•©ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
Liquid-ASA/
â”œâ”€â”€ ASA_LFM25_Pipeline.ipynb       # ğŸ““ LFM2.5 ë©”ì¸ ë…¸íŠ¸ë¶ (Colab T4)
â”œâ”€â”€ ASA_LFM25_LiquidPrompt.ipynb   # ğŸ““ Liquid ê³µì‹ í¬ë§· ì‹¤í—˜ (Maxime í”¼ë“œë°±)
â”œâ”€â”€ ASA_Qwen05B_Reproduction.ipynb # ğŸ““ Qwen2.5-0.5B ì¬í˜„
â”œâ”€â”€ ASA_Qwen15B_Reproduction.ipynb # ğŸ““ Qwen2.5-1.5B ì¬í˜„
â”œâ”€â”€ create_notebook.py              # LFM2.5 ë…¸íŠ¸ë¶ ìƒì„±
â”œâ”€â”€ create_qwen05b_notebook.py      # 0.5B ë…¸íŠ¸ë¶ ìƒì„±
â”œâ”€â”€ create_qwen15b_notebook.py      # 1.5B ë…¸íŠ¸ë¶ ìƒì„±
â”œâ”€â”€ data/
â”‚   â””â”€â”€ tools.json                  # 4ê°œ ë„êµ¬ ì •ì˜ (ìŠ¤í‚¤ë§ˆ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ asa_assets/                 # ğŸš€ LFM2.5 ë°°í¬ ì—ì…‹ (221KB)
â”‚   â””â”€â”€ asa_assets_qwen05b/         # ğŸš€ Qwen2.5-0.5B ì—ì…‹
â”œâ”€â”€ README.md
â”œâ”€â”€ README_KR.md
â”œâ”€â”€ requirements.txt
â””â”€â”€ LICENSE
```

## ë¹ ë¥¸ ì‹œì‘

### íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (Google Colab)

1. `ASA_LFM25_Pipeline.ipynb`ë¥¼ [Google Colab](https://colab.research.google.com/)ì— ì—…ë¡œë“œ
2. **T4 GPU** ëŸ°íƒ€ì„ ì„ íƒ
3. **ëª¨ë‘ ì‹¤í–‰** â€” ì´ ~30ë¶„

ë…¸íŠ¸ë¶ì´ ìë™ìœ¼ë¡œ Alpaca ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³ , ì „ì²´ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ê³ , ì—ì…‹ì„ `outputs/`ì— ì €ì¥í•©ë‹ˆë‹¤.

### ì—ì…‹ ì‚¬ìš© (ë¡œì»¬)

íŒŒì´í”„ë¼ì¸ì„ ë‹¤ì‹œ ì‹¤í–‰í•  í•„ìš” ì—†ì´, ì €ì¥ëœ ì—ì…‹ë§Œìœ¼ë¡œ ASAë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
import pickle, json, numpy as np, torch
from transformers import AutoTokenizer, AutoModelForCausalLM

# ëª¨ë¸ ë¡œë“œ
model = AutoModelForCausalLM.from_pretrained(
    "LiquidAI/LFM2.5-1.2B-Instruct",
    dtype=torch.float16, device_map="auto", trust_remote_code=True)
tokenizer = AutoTokenizer.from_pretrained(
    "LiquidAI/LFM2.5-1.2B-Instruct", trust_remote_code=True)

# ASA ì—ì…‹ ë¡œë“œ (ì´ 221KB)
vecs   = np.load("outputs/asa_assets/steering_vectors.npz")
router = pickle.load(open("outputs/asa_assets/router.pkl", "rb"))
probes = pickle.load(open("outputs/asa_assets/probes.pkl", "rb"))
scaler = pickle.load(open("outputs/asa_assets/scaler.pkl", "rb"))
config = json.load(open("outputs/asa_assets/config.json"))

# ASA hook ì •ì˜
_injected = False
def asa_hook(module, inp, out):
    global _injected
    if _injected: return out
    _injected = True
    h = out[0] if isinstance(out, tuple) else out
    hl = h[:, -1, :].detach().cpu().float().numpy()
    hs = scaler.transform(hl)
    dom = config["domains"][router.predict(hs)[0]]
    pt = probes[dom].predict_proba(hs)[0, 1] if dom in probes else 0.5
    gate = 1 if pt >= config["tau"] else (-1 if pt <= 1-config["tau"] else 0)
    if gate == 0: return out
    v = vecs[dom]; v = v / (np.linalg.norm(v) + 1e-8)
    vt = torch.tensor(v, dtype=torch.float16).to(h.device)
    hn = h.clone(); hn[:, -1, :] += gate * config["alpha"] * vt
    rest = out[1:] if isinstance(out, tuple) else None
    return (hn,) + rest if rest else hn

# ì‚¬ìš©ë²•
_injected = False
hook = model.model.layers[config["L_star"]].register_forward_hook(asa_hook)
# ... model.generate() í‰ì†Œì²˜ëŸ¼ ì‚¬ìš© ...
hook.remove()
```

### ëŒ€í™”í˜• ì±„íŒ… (Colab)

ë…¸íŠ¸ë¶ ë§ˆì§€ë§‰ì— ìƒˆ ì…€ ì¶”ê°€:

```python
while True:
    q = input("\nì§ˆë¬¸: ")
    if q.lower() in ("quit", "exit"): break
    msgs = [{"role": "system", "content": SYS_PROMPT},
            {"role": "user", "content": q}]
    bl = generate(msgs)
    _injected = False
    asa_out = generate(msgs, hook_fn=asa_hook, layer=L_STAR)
    print(f"[Baseline] {'ğŸ”§ TOOL' if TOOL_S in bl else 'ğŸ’¬ TEXT'}")
    print(bl[:300])
    print(f"[ASA]      {'ğŸ”§ TOOL' if TOOL_S in asa_out else 'ğŸ’¬ TEXT'}")
    print(asa_out[:300])
```

## LFM2.5 ì ì‘ ì‚¬í•­

| í•­ëª© | ASA ë…¼ë¬¸ (Qwen/LLaMA) | ì´ í”„ë¡œì íŠ¸ (LFM2.5) |
|------|------------------------|----------------------|
| ì•„í‚¤í…ì²˜ | Transformer ì „ìš© | í•˜ì´ë¸Œë¦¬ë“œ LIV conv + GQA |
| íŒŒë¼ë¯¸í„° | 1.5B / 8B | 1.17B |
| ë ˆì´ì–´ | 28â€“32 | 16 (10 LIV + 6 GQA) |
| ë„êµ¬ í† í° | `<functioncall>` | `<\|tool_call_start\|>` / `<\|tool_call_end\|>` |
| ë„êµ¬ í˜•ì‹ | JSON | Bracket í‘œê¸°ë²• `[func(args)]` |
| ìµœì  ë ˆì´ì–´ | L18â€“L21 | **L12** (GQA ë¸”ë¡) |
| ë°ì´í„° ì†ŒìŠ¤ | Alpaca + NQ | Alpaca (ìë™ ë‹¤ìš´ë¡œë“œ) |

## ì¸ìš©

```bibtex
@article{asa2025,
  title={ASA: Training-Free Representation Engineering for Tool-Calling Agents},
  author={...},
  journal={arXiv preprint arXiv:2602.04935},
  year={2025}
}
```

## ì°¸ê³ 

ì´ í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì‹¤í—˜ ì½”ë“œ, ë°ì´í„° íŒŒì´í”„ë¼ì¸, ë…¸íŠ¸ë¶ì€ Antigravity **Claude Opus 4.6**ì„ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

## ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” [Apache License 2.0](LICENSE)ì— ë”°ë¼ ë¼ì´ì„ ìŠ¤ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.
